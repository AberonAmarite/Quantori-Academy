!function(){let e,t=0;const n=["health","work","home","other"],a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],o=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function s({text:e,onClick:t}){const n=document.createElement("button");return n.innerHTML=e,n.onclick=t,n}function c({classNames:e}){const t=document.createElement("div");return t.classList.add(...e),t}function l({text:e}){const t=document.createElement("p");return t.innerHTML=e,t}function i({text:e,type:t}){if(t>0&&t<7){let n="h"+t;const a=document.createElement(n);return a.innerHTML=e,a}}function d(e){const t=document.createElement("input");return t.type="search",t.placeholder=e,t}function r(e,t,n){let a="completed",o=()=>{};t&&(a="current",o=()=>n(e));const l=c({classNames:["row",a]}),d=s({text:"",onClick:o});d.className=`${a}__checkbox`;const r=c({classNames:["column",`${a}__main-text`]}),y=i({text:e.title,type:3});y.className=`${a}__title`;const f=c({classNames:["row"]}),g=c({classNames:[]}),_=c({classNames:["tag",`tag-${e.tag}`]});_.innerHTML=e.tag,g.append(_);const w=c({classNames:[`${a}__deadline`]}),N=new Date,C=new Date(e.deadline);let T=p(N),k=p(C),x=u(N),L=u(C);if(x[1]==L[1]&&x[2]==L[2]?T[1]==k[1]?w.innerHTML="Today":T[1]+1==k[1]?w.innerHTML="Tomorrow":w.innerHTML=`${h(k[0])}, ${k[1]} ${m(k[2])}`:w.innerHTML=`${h(k[0])}, ${k[1]} ${m(k[2])}`,f.append(g,w),r.append(y,f),l.append(d,r),"current"===a){const n=s({text:"",onClick:()=>{t(e)}});n.className="current__delete",l.append(n)}return l}function p(e){let t=e.getMonth();return[e.getDay(),e.getDate(),t]}function u(e){let t=e.getMonth()>9?e.getMonth()+1:"0"+(e.getMonth()+1);return[e.getDate()>9?e.getDate():"0"+e.getDate(),t,e.getFullYear()]}function m(e){return a[e]}function h(e){return o[e]}function y(e){e.style.visibility="hidden"}function f(e,t){return fetch(`https://api.weatherapi.com/v1/current.json?key=65617eb0a32644169e561914231904&q=${e},${t}&aqi=no`).then((e=>e.json())).then((e=>({location:e.location,current:e.current})))}function g(e){const t=c({classNames:["row","header__top"]}),n=function(){const e=document.createElement("header");return e.classList.add("header"),e}(),a=function(){const e=e=>{const n=c({classNames:["header__weather-temperature"]}),a=c({classNames:["header__city"]}),o=function(e,t,n){const a=document.createElement("img");return a.src=e,a.width=57,a}(e.current.condition.icon);a.innerText=e.location.name,n.innerText=e.current.temp_c+"Â°C",t.append(o,n,a)},t=c({classNames:["row","header__weather"]});return new Promise(((e,t)=>{navigator.geolocation?navigator.geolocation.getCurrentPosition((t=>{const n=t.coords.latitude,a=t.coords.longitude;e({latitude:n,longitude:a})}),(e=>{console.log("Unable to retrieve your location"),t(e)})):t("Geolocation is not supported by your browser")})).catch((()=>{console.log("location problem")})).then((t=>{f(t.latitude,t.longitude).then(e).catch((()=>{}))})).catch((()=>{f(41.6938,44.8015).then(e).catch((()=>{}))})),t}(),o=i({text:"To Do List",type:1});o.classList.add("header__title"),t.append(o,a),n.append(t);const l=c({classNames:["header__main"]}),r=d("Search Task");function p(e,t,n){for(let a=0;a<e.length;a++)e[a].querySelector(n).textContent.toLowerCase().includes(t)?e[a].classList.remove("display-none"):e[a].classList.add("display-none")}r.classList.add("search-input"),r.oninput=()=>{const e=r.value.toLowerCase(),t=document.getElementsByClassName("current"),n=document.getElementsByClassName("completed");p(t,e,".current__title"),p(n,e,".completed__title")};const u=s({text:"+ New Task",onClick:()=>{e.style.visibility="visible"}});return u.classList.add("header__new-task"),l.append(r,u),n.append(l),n}function _(){const a=document.createElement("div");return async function(){t=await async function(){try{const e=await fetch("http://localhost:3004/counter");return(await e.json()).count}catch(e){console.error("Error fetching ID counter:",e),document.getElementById("root").append(i({text:"Sorry! We are experiencing a server error",type:1}))}}();const o=function(a){let r=c({classNames:["modal"]}),p=c({classNames:["modal-content"]}),m=i({text:"Add Task",type:2});p.appendChild(m);let f=document.createElement("form"),g=d("Task Title");g.type="text",g.id="taskName",g.classList.add("search-input"),g.classList.add("modal__task-title"),f.appendChild(g);let w=c({classNames:["modal__tags"]}),N="tag";for(let e=0;e<n.length;e++){let t=s({text:n[e],onClick:a=>{a.preventDefault(),N=n[e];const o=window.getComputedStyle(t).getPropertyValue("color");for(element of(t.style.border=`1px solid ${o}`,w.getElementsByClassName("tag")))element.innerHTML!=N&&(element.style.border="1px solid white")}});t.classList.add("tag",`tag-${n[e]}`),t.id=n[e],w.appendChild(t)}let C=document.createElement("input");C.type="date",C.id="deadlineDate",C.name="deadlineDate",C.style.visibility="hidden",C.style.position="absolute";const T=u(new Date);let k=`${T[2]}-${T[1]}-${T[0]}`;C.defaultValue=k;const x=u(new Date(C.value));let L=`${x[0]}.${x[1]}.${x[2]}`,$=s({text:"",onClick:e=>{C.showPicker(),e.preventDefault()}});$.className="modal__deadline";const E=l({text:L});$.append(E,C),C.onchange=function(){const e=u(new Date(C.value));E.innerText=`${e[0]}.${e[1]}.${e[2]}`};const v=c({classNames:["row","modal__row1"]}),b=c({classNames:["row","modal__row2"]});v.append(w,$),f.append(v);let D=s({text:"Add Task",onClick:()=>{!function(n,a,s){const c={title:n,deadline:a,tag:s,isCompleted:!1};h([..._,c],e),y(o),t++,async function(){await fetch("http://localhost:3004/tasks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t,title:n,deadline:a,tag:s,isCompleted:!1})}).then(fetch("http://localhost:3004/counter",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({count:t})}))}()}(g.value,C.value,N)}});D.type="button",D.id="addTask",D.classList.add("modal__add-task");let M=s({text:"Cancel",onClick:()=>{y(r)}});return M.type="button",M.id="cancel",M.classList.add("modal__cancel"),g.oninput=()=>{g.value.length?D.classList.add("modal__add-task--complete"):D.classList.remove("modal__add-task--complete")},b.append(M,D),f.append(b),p.appendChild(f),r.appendChild(p),document.body.appendChild(r),r}();y(o);const p=await async function(){const e=await fetch("http://localhost:3004/tasks");return await e.json()}(),[m,h]=(e=e||p||[],[e,function(t){e=t,w()}]);null==t&&(t=(new Date).getMilliseconds());let f=m.filter((e=>e.isCompleted)),_=m.filter((e=>!e.isCompleted));const N=document.createElement("main",{classNames:["main"]});if(a.append(g(o),N),N.append(i({text:"Current Tasks",type:2})),_.length>0){const e=c({classNames:[]});_.forEach((t=>{e.append(function(e,t,n){return r(e,t,n)}(t,C,T))})),N.append(e)}else N.append(l({text:"No current tasks"}));async function C(t){const n=m.filter((e=>e!==t));h(n,e),await fetch("http://localhost:3004/tasks/"+t.id,{method:"DELETE"})}async function T(e){m.forEach((t=>{t===e&&(t.isCompleted=!0)})),w(),await fetch("http://localhost:3004/tasks/"+e.id,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}if(N.append(i({text:"Completed Tasks",type:2})),f.length>0){const e=c({classNames:[]});f.forEach((t=>{e.append(r(t))})),N.append(e)}else N.append(l({text:"No completed tasks"}))}(),a}function w(){const e=document.getElementById("root");e.innerHTML="",e.append(_())}w()}();